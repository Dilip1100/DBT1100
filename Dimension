# Host Table Creation 

CREATE TABLE SRC_HOSTS AS
SELECT
    ID AS HOST_ID,
NVL(
name,
'Anonymous'
) AS HOST_NAME,
is_superhost AS IS_SUPERHOST,
    CREATED_AT,
    UPDATED_AT
FROM
    AIRBNB.RAW.RAW_HOSTS;

# Listing Table Creation  

CREATE TABLE SRC_LISTINGS AS
SELECT
    id AS listing_id,
    name AS listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$', '')::NUMBER(10, 2) AS price,

CREATE TABLE DIM_LST_HST AS 
SELECT L.LISTING_ID, L.LISTING_NAME, L.ROOM_TYPE, L.MINIMUM_NIGHTS, L.PRICE, L.HOST_ID, H.HOST_NAME, H.IS_SUPERHOST, L.CREATED_AT, GREATEST(L.UPDATED_AT, H.UPDATED_AT) AS UPDATED_AT
FROM LISTINGS_CLEANSED AS L JOIN HOSTS_CLEANSED AS H ON L.HOST_ID = H.HOST_ID
    created_at,
    updated_at
FROM
    AIRBNB.RAW.RAW_LISTINGS;
